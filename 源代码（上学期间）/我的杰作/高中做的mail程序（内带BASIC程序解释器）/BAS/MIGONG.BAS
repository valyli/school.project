10 CLEAR
SCREEN 1
CLS
KEY OFF
COLOR 0, 1
LOCATE 12, 12
GOSUB 670
CLS
LOCATE 7, 1
110 INPUT "KUAN(1-79)?", WIDE
IF WIDE > 0 AND WIDE < 80 THEN 160
BEEP
GOTO 110
160 INPUT "CHANG(1-49)?", HIGH
IF HIGH > 0 AND HIGH < 50 THEN 220
BEEP
GOTO 160
220 WINC = 320 \ (WIDE + 1)
HINC = 200 \ (HIGH + 1)
CLS
LINE (0, 0)-(WIDE * WINC, HIGH * HINC), B
COUNT = WIDE * HIGH
FOR I = 0 TO COUNT
PTR = (PTR + 997) MOD COUNT
X = INT(PTR / HIGH)
Y = PTR - X * HIGH
X = X * WINC
Y = Y * HINC
IF POINT(X, Y) THEN 560
DIR = INT(4 * RND + 1)
DIR2 = DIR
360 DIR = DIR MOD 4 + 1
XN = ((DIR = 1) - (DIR = 3)) * WINC + X
YN = ((DIR = 2) - (DIR = 4)) * HINC + Y
IF POINT(XN, YN) = 0 THEN 510
LINE (X, Y)-(XN, YN)
410 DIR = INT(4 * RND + 1)
FOR K = 1 TO 4
DIR = DIR MOD 4 + 1
XN = ((DIR = 1) - (DIR = 3)) * WINC + X
YN = ((DIR = 2) - (DIR = 4)) * HINC + Y
IF POINT(XN, YN) THEN 550
LINE (X, Y)-(XN, YN)
X = XN
Y = YN
GOTO 410
510 IF DIR <> DIR2 THEN 540
X = XN
Y = YN
540 GOTO 360
550 NEXT K
560 NEXT I
'
Y = (HIGH \ 2) * HINC
LINE (0, Y)-(0, Y + HINC), 0
LINE (WIDE * WINC, Y)-(WIDE * WINC, Y + HINC), 0
'
640 K$ = INKEY$
IF K$ = " " THEN 640
GOTO 760
670 LOCATE 25, 9
PRINT "Press any key.";
690 RNDM = RND
K$ = INKEY$
IF K$ = " " THEN 690
RANDOMIZE 64000! * RND - 32000
LOCATE 25, 1
PRINT SPACE$(39);
RETURN
760
INPUT "Do you want to contine (Y/N)?", REPLY$
IF REPLY$ <> "Y" AND REPLY$ <> "Y" THEN 800
GOTO 10
800 END






