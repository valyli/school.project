<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0051)http://asp.7i24.com/sg/tech/software/2000.09.25.htm -->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=gb2312">
<META 
content="经济; IT产业; 金融; 投资; 经营; 技术; 网络; 软件开发; 安全技术; 站点制作; 免费; free; internet; wwwboard; headlines; downloads; news; Web site; what's new; solutions; services; software; contests; corporate news;" 
name=KEYWORDS>
<META content=网妹中国资讯网 name=description>
<STYLE type=text/css>BODY {
	FONT-SIZE: 9pt; COLOR: #000000; FONT-FAMILY: 宋体
}
.pt9 {
	FONT-SIZE: 9pt; FONT-FAMILY: "宋体"
}
.pt11 {
	FONT-WEIGHT: bold; FONT-SIZE: 11pt; COLOR: #336699; FONT-FAMILY: "宋体"
}
TT {
	FONT-WEIGHT: bold; FONT-SIZE: 10.5pt; COLOR: #000000; FONT-FAMILY: "宋体"
}
H5 {
	FONT-WEIGHT: bold; FONT-SIZE: 12pt; COLOR: #000000; FONT-FAMILY: "宋体"
}
P {
	FONT-SIZE: 9pt; COLOR: #000000; FONT-FAMILY: "宋体"
}
H9 {
	FONT-SIZE: 9pt; FONT-FAMILY: "宋体"
}
TD {
	FONT-SIZE: 9pt; FONT-FAMILY: "宋体"
}
SELECT {
	FONT-SIZE: 9pt; FONT-FAMILY: "宋体"
}
A:link {
	FONT-SIZE: 9pt; COLOR: #0022aa; FONT-FAMILY: "宋体"; TEXT-DECORATION: none
}
A:visited {
	FONT-SIZE: 9pt; COLOR: #0022aa; FONT-FAMILY: "宋体"; TEXT-DECORATION: none; font-color: blue
}
A:hover {
	FONT-SIZE: 9pt; COLOR: red; FONT-FAMILY: "宋体"; TEXT-DECORATION: underline
}
</STYLE>

<STYLE type=text/css>.d {
	LINE-HEIGHT: 12pt; MARGIN-RIGHT: 15px; TEXT-ALIGN: justify
}
</STYLE>

<SCRIPT language=JavaScript src="VC中多语菜单的实现.files/hermes.js" 1.1></SCRIPT>

<META content="MSHTML 5.50.4134.100" name=GENERATOR></HEAD>
<BODY bgColor=#ffffff leftMargin=0 topMargin=0 MARGINWIDTH="0" 
MARGINHEIGHT="0"><A name=index></A>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top align=left width="17%" height=650>
      <TABLE height="100%" cellSpacing=0 cellPadding=0 width="100%" align=left 
      border=0 valign="top">
        <TBODY>
        <TR>
          <TD vAlign=top align=middle bgColor=#ffe4b5>
            <TABLE height=80 cellSpacing=0 cellPadding=0 width="90%" 
            align=center border=0 valign="top">
              <TBODY>
              <TR>
                <TD align=middle><IMG src="VC中多语菜单的实现.files/logo.gif"></TD></TR>
              <TR>
                <TD align=middle><FONT size=2><A 
                  href="http://www.hermes.com.cn/">http://www.hermes.com.cn/</A></FONT></TD></TR>
              <TR>
                <TD vAlign=top align=middle width="100%" bgColor=#ffe4b5><IMG 
                  height=18 alt=海脉技术纵横 src="VC中多语菜单的实现.files/jishu.gif" 
                  width=120 border=0></TD></TR>
              <TR>
                <TD vAlign=top align=left width="100%" bgColor=#ffe4b5 
                  height=2><IMG height=2 src="VC中多语菜单的实现.files/blank.gif"></TD></TR>
              <TR>
                <TD vAlign=top width="100%" bgColor=#ffcf80 height=10><FONT 
                  color=#e0611e>◆</FONT><A target=rightdown 
                  href="http://asp.7i24.com/sg/tech/techinfo/index.htm">&nbsp;<H9>技术动态</H9></A></TD></TR>
              <TR>
                <TD vAlign=top align=left width="100%" bgColor=#ffe4b5 
                  height=2><IMG height=2 src="VC中多语菜单的实现.files/blank.gif"></TD></TR>
              <TR>
                <TD vAlign=top width="100%" bgColor=#ffcf80 height=10><FONT 
                  color=#e0611e>◆</FONT><A target=rightdown 
                  href="http://asp.7i24.com/sg/tech/network/index.htm">&nbsp;<H9>网络技术</H9></A></TD></TR>
              <TR>
                <TD vAlign=top align=left width="100%" bgColor=#ffe4b5 
                  height=2><IMG height=2 src="VC中多语菜单的实现.files/blank.gif"></TD></TR>
              <TR>
                <TD vAlign=top width="100%" bgColor=#ffcf80 height=10><FONT 
                  color=#e0611e>◆</FONT><A target=rightdown 
                  href="http://asp.7i24.com/sg/tech/software/index.htm">&nbsp;<H9>软件开发</H9></A></TD></TR>
              <TR>
                <TD vAlign=top align=left width="100%" bgColor=#ffe4b5 
                  height=2><IMG height=2 src="VC中多语菜单的实现.files/blank.gif"></TD></TR>
              <TR>
                <TD vAlign=top width="100%" bgColor=#ffcf80 height=10><FONT 
                  color=#e0611e>◆</FONT><A target=rightdown 
                  href="http://asp.7i24.com/sg/tech/security/index.htm">&nbsp;<H9>安全技术</H9></A></TD></TR>
              <TR>
                <TD vAlign=top align=left width="100%" bgColor=#ffe4b5 
                  height=2><IMG height=2 src="VC中多语菜单的实现.files/blank.gif"></TD></TR>
              <TR>
                <TD vAlign=top width="100%" bgColor=#ffcf80 height=10><FONT 
                  color=#e0611e>◆</FONT><A target=rightdown 
                  href="http://asp.7i24.com/sg/tech/pagemake/index.htm">&nbsp;<H9>站点制作</H9></A></TD></TR>
              <TR>
                <TD vAlign=top align=left width="100%" bgColor=#ffe4b5 
                  height=2><IMG height=2 src="VC中多语菜单的实现.files/blank.gif"></TD></TR>
              <TR>
                <TD vAlign=top width="100%" bgColor=#ffcf80 height=10><FONT 
                  color=#e0611e>◆</FONT><A target=rightdown 
                  href="http://asp.7i24.com/sg/tech/faq/index.htm">&nbsp;<H9>技术问答</H9></A></TD></TR>
              <TR>
                <TD vAlign=top align=left width="100%" bgColor=#ffe4b5 
                  height=2><IMG height=2 
              src="VC中多语菜单的实现.files/blank.gif"></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><!-- 左MENU代码结束  //--></TD>
    <TD vAlign=top align=left width="83%" height=650>
      <TABLE height=70 cellSpacing=0 cellPadding=2 width="100%" bgColor=#ffffff 
      border=0>
        <TBODY>
        <TR>
          <TD vAlign=BUTTOM align=left width="70%" bgColor=#ffffff 
            height=60><IFRAME marginWidth=0 marginHeight=0 
            src="VC中多语菜单的实现.files/iframe.htm" frameBorder=0 width=468 
            scrolling=no 
            height=60> <a href="http://ad.hermes.com.cn/clickbanner.php?member=hermes"><img width="468" height="60" border="0" src="http://ad.hermes.com.cn/banner.php?size=0&member=hermes"></a></IFRAME><BR>
            <CENTER><A target=_blank 
            href="http://www.healliance.com/"></A></CENTER></TD>
          <TD vAlign=BUTTOM align=left width="30%" bgColor=#ffffff 
            height=60>&nbsp; </TD></TR></TBODY></TABLE>
      <TABLE height=500 cellSpacing=0 cellPadding=0 width="100%" bgColor=#ffffff 
      border=0>
        <TBODY>
        <TR>
          <TD vAlign=center align=left width="80%" bgColor=#ffe4b5 
            height=10>&nbsp;&nbsp;目前位置:<A 
            href="http://asp.7i24.com/sg/tech/rightnew.html">首页</A>&gt;&gt;软件开发 
          </TD>
          <TD vAlign=center align=middle width="20%" bgColor=#ececec 
            height=10>2000.9.25 </TD></TR>
        <TR>
          <TD vAlign=buttom align=middle width="100%" bgColor=#ffffff colSpan=2 
          height=430><!-- 添加内容开始  //-->
            <TABLE cellPadding=10 width="100%" border=0>
              <TBODY>
              <TR>
                <TD height=2>
                  <DIV align=left><BIG><B>软件开发</B></BIG> 
                  <H3>
                  <CENTER>VC中多语菜单的实现</CENTER></H3>　　VC中实现多语菜单非常容易，下面以英汉对照菜单为例说明多语菜单实现的方法。<BR><BR>　　一、建立工程项目文件 
                  <BR><BR>　　采用VC中应用程序向导（AppWizard）建立一个工程项目：Menu。在可选者项中，选者单文档，语言为汉语，其余选者默认项。此时编译运行得到一个具有中文菜单的应用程序。下面将加入英文菜单到应用程序中。<BR><BR>　　二、修改建立菜单资源 
                  <BR><BR>　　在资源编辑器中打开菜单资源编辑器编辑IDR_MAINFRAME菜单资源，加入改变菜单的开关命令项。在查看项 
                  <BR><BR>　　下加入菜单： <BR><BR>　　ID: ID_MENU_CHANGE Caption 
                  英语(&amp;E) <BR><BR>　　 
                  　　关闭资源编辑器。用Windows的写字板打开项目下的资源文件Menu.rc找到如下内容： <BR><BR><XMP>
IDR_MAINFRAME MENU PRELOAD DISCARDABLE 

BEGIN 

POPUP "文件(&F)" 

BEGIN 

MENUITEM "新建(&N)\tCtrl+N", ID_FILE_NEW 

MENUITEM "打开(&O)...\tCtrl+O", ID_FILE_OPEN 

MENUITEM "保存(&S)\tCtrl+S", ID_FILE_SAVE 

MENUITEM "另存为(&A)...", ID_FILE_SAVE_AS 

MENUITEM SEPARATOR 

MENUITEM "打印(&P)...\tCtrl+P", ID_FILE_PRINT 

MENUITEM "打印预览(&V)", ID_FILE_PRINT_PREVIEW 

MENUITEM "打印设置(&R)...", ID_FILE_PRINT_SETUP 

MENUITEM SEPARATOR 

MENUITEM "最近文件", ID_FILE_MRU_FILE1, GRAYED 

MENUITEM SEPARATOR 

MENUITEM "退出(&X)", ID_APP_EXIT 

END 

POPUP "编辑(&E)" 

BEGIN 

MENUITEM "撤消(&U)\tCtrl+Z", ID_EDIT_UNDO 

MENUITEM SEPARATOR 

MENUITEM "剪切(&T)\tCtrl+X", ID_EDIT_CUT 

MENUITEM "复制(&C)\tCtrl+C", ID_EDIT_COPY 

MENUITEM "粘贴(&P)\tCtrl+V", ID_EDIT_PASTE 

END 

POPUP "查看(&V)" 

BEGIN 

MENUITEM "工具栏(&T)", ID_VIEW_TOOLBAR 

MENUITEM "状态栏(&S)", ID_VIEW_STATUS_BAR 

MENUITEM "英语", ID_MENU_CHANGE 

END 

POPUP "帮助(&H)" 

BEGIN 

MENUITEM "关于 Menu(&A)...", ID_APP_ABOUT 

END 

END 

  将上述内容复制到剪贴板中，然后拷贝一份到上述内容的下面，并作部分修改。将IDR_MAINFRAME改为 

IDR_MAINFRAME_EN,其他汉语译成英语，并按英语菜单的习惯修改。改后的菜单资源如下： 

IDR_MAINFRAME_EN MENU PRELOAD DISCARDABLE 

BEGIN 

POPUP "&File" 

BEGIN 

MENUITEM "New(&N)\tCtrl+N", ID_FILE_NEW 

MENUITEM "Open(&O)...\tCtrl+O", ID_FILE_OPEN 

MENUITEM "Save(&S)\tCtrl+S", ID_FILE_SAVE 

MENUITEM "Save As(&A)...", ID_FILE_SAVE_AS 

MENUITEM SEPARATOR 

　 MENUITEM "&Print...\tCtrl+P", ID_FILE_PRINT 

MENUITEM "Print Pre&view", ID_FILE_PRINT_PREVIEW 

MENUITEM "&Printer Reset...", ID_FILE_PRINT_SETUP 

MENUITEM SEPARATOR 

MENUITEM "Re￠ File", ID_FILE_MRU_FILE1, GRAYED 

MENUITEM SEPARATOR 

MENUITEM "E(&X)it", ID_APP_EXIT 

END 

POPUP "(&E)dit" 

BEGIN 

MENUITEM "&Undo\tCtrl+Z", ID_EDIT_UNDO 

MENUITEM SEPARATOR 

MENUITEM "Cu&T\tCtrl+X", ID_EDIT_CUT 

MENUITEM "&Copy\tCtrl+C", ID_EDIT_COPY 

MENUITEM "&Paste\tCtrl+V", ID_EDIT_PASTE 

END 

POPUP "&View" 

BEGIN 

MENUITEM "&Tool bar", ID_VIEW_TOOLBAR 

MENUITEM "&Status bar", ID_VIEW_STATUS_BAR 

MENUITEM "&Chinese", ID_MENU_CHANGE 

END 

POPUP "&Help" 

BEGIN 

MENUITEM "&About Menu...", ID_APP_ABOUT 

END 

END 

   OK， 保存修改后的资源文件。把资源文件重新调入资源编辑器，可发现已有两套菜单资源。如有什么不合
适的地方可在资源编辑器中做进一步修改。 

     三、加入菜单变量到程序中 

     由于菜单附属于主窗口，所以应在CMainFrame类中加入相关变量： 

public: 

CMenu m_pEnglish;\\用于保存英语菜单资源 

CMenu m_pChinese;\\用于保存汉语菜单资源 

enum{C,E}m_eMenu;\\标示现在使用的是英语菜单还是汉语菜单，C--汉语，E--英语 

     四、初始化变量 需要初始化的变量仅有一个m_eMenu。由于开始时菜单使用默认中文菜单，所以在 

CMainFrame构造函数中初始化： 

CMainFrame::CMainFrame() 

{ 

// TODO: add member initialization code here 

m_Menu=C; 

} 

     五、调入保存菜单资源 

     在主窗口的OnCreate函数中，初始化并保存菜单资源： 

int CMainFrame::OnCreate(LPCREATESTRUCT lpCreateStruct) 

{ 

....... 

m_pEnglish.LoadMenu(IDR_MAINFRAME_EN);\\调入英文菜单资源 

HMENU hm=::GetMenu(this- >m_hWnd) ;\\获得中文菜单资源 

m_pChinese.Attach(hm); \\保存中文菜单资源 

return 0; 

} 

     六、响应改变菜单命令 

     利用ClassWizard为CMainFrame类加入ID_MENU_CHANGE菜单命令响应函数： 

void CMainFrame::OnMenuChange() 

{ 

// TODO: Add your command handler code here 

if(m_Menu==E) //如果现在菜单为英语 

{ 

SetMenu(&m_pChinese);// 把菜单设置为汉语 

m_Menu=C; 

} 

else if(m_Menu==C) //如果现在菜单为汉语 

{ 

SetMenu(&m_pEnglish);//设置菜单为英语 

m_Menu=E; 

} 

} 
    七、销毁菜单 

     在CMainFrame的析够函数中销毁菜单： 

CMainFrame::~CMainFrame() 

{ 

m_pChinese.DestroyMenu(); 

m_pEnglish.DestroyMenu(); 

} 
</XMP>　　编译运行程序您就可以获得一个具有英汉对照菜单的应用程序。 
                  　　上述例子虽然只给除了两种语言的菜单，但很容易编出多语言菜单的应用程序。由于各种语言菜单实际上是不同的菜单资源，所以，在同一应用程序中，可以使用不同的菜单。如共享软件中注册的用户使用一种菜单，未注册的用户使用另一种菜单，而不必发行多个版本和多次安装，从而使注册变得容易并能得到软件更多的功能。 
                  <BR><BR></DIV></TD></TR></TBODY></TABLE><!-- 添加内容结束  //--></TD></TR>
        <TR>
          <TD vAlign=buttom align=middle width="100%" bgColor=#ffffff colSpan=2 
          height=10>|<A 
            href="http://asp.7i24.com/sg/tech/software/2000.09.25.htm#index">回顶部</A>|<A 
            href="javascript:(history.go(-1))">上一页</A>|<A 
            href="http://asp.7i24.com/index.html">主页面</A>| </TD></TR>
        <TR>
          <TD vAlign=buttom align=middle width="100%" bgColor=#ffffff colSpan=2 
          height=30>
            <P align=center>
            <HR color=#0066cc SIZE=1>
            <BR>建议使用800*600的分辩率，IE4以上的浏览器浏览以取得良好的效果 <BR>Copyright (C) 2001-2002 
            Netmay.Com All Rights Reserved<BR>Email: <A 
            href="mailto:skyidea@hotmail.com">skyidea@hotmail.com</A> 
            QQ:83150<BR></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></BODY></HTML>
