<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0051)http://asp.7i24.com/sg/tech/software/2001.01.05.htm -->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=gb2312">
<META http-equiv=Page-Enter content=revealTrans(Duration=4.0,Transition=23)>
<META 
content="经济; IT产业; 金融; 投资; 经营; 技术; 网络; 软件开发; 安全技术; 站点制作; 免费; free; internet; wwwboard; headlines; downloads; news; Web site; what's new; solutions; services; software; contests; corporate news;" 
name=KEYWORDS>
<META content=网妹中国资讯网 name=description>
<STYLE type=text/css>BODY {
	FONT-SIZE: 9pt; COLOR: #000000; FONT-FAMILY: 宋体
}
.pt9 {
	FONT-SIZE: 9pt; FONT-FAMILY: "宋体"
}
.pt11 {
	FONT-WEIGHT: bold; FONT-SIZE: 11pt; COLOR: #336699; FONT-FAMILY: "宋体"
}
TT {
	FONT-WEIGHT: bold; FONT-SIZE: 10.5pt; COLOR: #000000; FONT-FAMILY: "宋体"
}
H5 {
	FONT-WEIGHT: bold; FONT-SIZE: 12pt; COLOR: #000000; FONT-FAMILY: "宋体"
}
P {
	FONT-SIZE: 9pt; COLOR: #000000; FONT-FAMILY: "宋体"
}
H9 {
	FONT-SIZE: 9pt; FONT-FAMILY: "宋体"
}
TD {
	FONT-SIZE: 9pt; FONT-FAMILY: "宋体"
}
SELECT {
	FONT-SIZE: 9pt; FONT-FAMILY: "宋体"
}
A:link {
	FONT-SIZE: 9pt; COLOR: #0022aa; FONT-FAMILY: "宋体"; TEXT-DECORATION: none
}
A:visited {
	FONT-SIZE: 9pt; COLOR: #0022aa; FONT-FAMILY: "宋体"; TEXT-DECORATION: none; font-color: blue
}
A:hover {
	FONT-SIZE: 9pt; COLOR: red; FONT-FAMILY: "宋体"; TEXT-DECORATION: underline
}
</STYLE>

<STYLE type=text/css>.d {
	LINE-HEIGHT: 12pt; MARGIN-RIGHT: 15px; TEXT-ALIGN: justify
}
</STYLE>

<SCRIPT language=JavaScript src="用V C++检测和隔离内存泄漏(二.files/hermes.js" 
1.1></SCRIPT>

<META content="MSHTML 5.50.4134.100" name=GENERATOR></HEAD>
<BODY bgColor=#ffffff leftMargin=0 topMargin=0 MARGINWIDTH="0" 
MARGINHEIGHT="0"><A name=index></A>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top align=left width="17%" height=650>
      <TABLE height="100%" cellSpacing=0 cellPadding=0 width="100%" align=left 
      border=0 valign="top">
        <TBODY>
        <TR>
          <TD vAlign=top align=middle bgColor=#ffe4b5>
            <TABLE height=80 cellSpacing=0 cellPadding=0 width="90%" 
            align=center border=0 valign="top">
              <TBODY>
              <TR>
                <TD align=middle><IMG 
                src="用V C++检测和隔离内存泄漏(二.files/logo.gif"></TD></TR>
              <TR>
                <TD align=middle><FONT size=2><A 
                  href="http://www.hermes.com.cn/">http://www.hermes.com.cn/</A></FONT></TD></TR>
              <TR>
                <TD vAlign=top align=middle width="100%" bgColor=#ffe4b5><IMG 
                  height=18 alt=海脉技术纵横 src="用V C++检测和隔离内存泄漏(二.files/jishu.gif" 
                  width=120 border=0></TD></TR>
              <TR>
                <TD vAlign=top align=left width="100%" bgColor=#ffe4b5 
                  height=2><IMG height=2 
                src="用V C++检测和隔离内存泄漏(二.files/blank.gif"></TD></TR>
              <TR>
                <TD vAlign=top width="100%" bgColor=#ffcf80 height=10><FONT 
                  color=#e0611e>◆</FONT><A target=rightdown 
                  href="http://asp.7i24.com/sg/tech/techinfo/index.htm">&nbsp;<H9>技术动态</H9></A></TD></TR>
              <TR>
                <TD vAlign=top align=left width="100%" bgColor=#ffe4b5 
                  height=2><IMG height=2 
                src="用V C++检测和隔离内存泄漏(二.files/blank.gif"></TD></TR>
              <TR>
                <TD vAlign=top width="100%" bgColor=#ffcf80 height=10><FONT 
                  color=#e0611e>◆</FONT><A target=rightdown 
                  href="http://asp.7i24.com/sg/tech/network/index.htm">&nbsp;<H9>网络技术</H9></A></TD></TR>
              <TR>
                <TD vAlign=top align=left width="100%" bgColor=#ffe4b5 
                  height=2><IMG height=2 
                src="用V C++检测和隔离内存泄漏(二.files/blank.gif"></TD></TR>
              <TR>
                <TD vAlign=top width="100%" bgColor=#ffcf80 height=10><FONT 
                  color=#e0611e>◆</FONT><A target=rightdown 
                  href="http://asp.7i24.com/sg/tech/software/index.htm">&nbsp;<H9>软件开发</H9></A></TD></TR>
              <TR>
                <TD vAlign=top align=left width="100%" bgColor=#ffe4b5 
                  height=2><IMG height=2 
                src="用V C++检测和隔离内存泄漏(二.files/blank.gif"></TD></TR>
              <TR>
                <TD vAlign=top width="100%" bgColor=#ffcf80 height=10><FONT 
                  color=#e0611e>◆</FONT><A target=rightdown 
                  href="http://asp.7i24.com/sg/tech/security/index.htm">&nbsp;<H9>安全技术</H9></A></TD></TR>
              <TR>
                <TD vAlign=top align=left width="100%" bgColor=#ffe4b5 
                  height=2><IMG height=2 
                src="用V C++检测和隔离内存泄漏(二.files/blank.gif"></TD></TR>
              <TR>
                <TD vAlign=top width="100%" bgColor=#ffcf80 height=10><FONT 
                  color=#e0611e>◆</FONT><A target=rightdown 
                  href="http://asp.7i24.com/sg/tech/pagemake/index.htm">&nbsp;<H9>站点制作</H9></A></TD></TR>
              <TR>
                <TD vAlign=top align=left width="100%" bgColor=#ffe4b5 
                  height=2><IMG height=2 
                src="用V C++检测和隔离内存泄漏(二.files/blank.gif"></TD></TR>
              <TR>
                <TD vAlign=top width="100%" bgColor=#ffcf80 height=10><FONT 
                  color=#e0611e>◆</FONT><A target=rightdown 
                  href="http://asp.7i24.com/sg/tech/faq/index.htm">&nbsp;<H9>技术问答</H9></A></TD></TR>
              <TR>
                <TD vAlign=top align=left width="100%" bgColor=#ffe4b5 
                  height=2><IMG height=2 
                src="用V C++检测和隔离内存泄漏(二.files/blank.gif"></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><!-- 左MENU代码结束  //--></TD>
    <TD vAlign=top align=left width="83%" height="100%">
      <TABLE height=70 cellSpacing=0 cellPadding=2 width="100%" bgColor=#ffffff 
      border=0>
        <TBODY>
        <TR>
          <TD vAlign=BUTTOM align=left width="70%" bgColor=#ffffff 
            height=60><IFRAME marginWidth=0 marginHeight=0 
            src="用V C++检测和隔离内存泄漏(二.files/iframe.htm" frameBorder=0 width=468 
            scrolling=no 
            height=60> <a href="http://ad.hermes.com.cn/clickbanner.php?member=hermes"><img width="468" height="60" border="0" src="http://ad.hermes.com.cn/banner.php?size=0&member=hermes"></a></IFRAME><BR>
            <CENTER><A target=_blank 
            href="http://www.healliance.com/"></A></CENTER></TD>
          <TD vAlign=BUTTOM align=left width="30%" bgColor=#ffffff 
            height=60>&nbsp; </TD></TR></TBODY></TABLE>
      <TABLE height="100%" cellSpacing=0 cellPadding=0 width="100%" 
      bgColor=#ffffff border=0>
        <TBODY>
        <TR>
          <TD vAlign=center align=left width="80%" bgColor=#ffe4b5 
            height=10>&nbsp;&nbsp;目前位置:<A 
            href="http://asp.7i24.com/sg/tech/rightnew.html">首页</A>&gt;&gt;软件开发 
          </TD>
          <TD vAlign=center align=middle width="20%" bgColor=#ececec 
            height=10>2001.01.05 </TD></TR>
        <TR>
          <TD vAlign=buttom align=middle width="100%" bgColor=#ffffff colSpan=2 
          height="100%"><!-- 添加内容开始  //-->
            <TABLE cellPadding=10 width="100%" border=0>
              <TBODY>
              <TR>
                <TD height=2>
                  <DIV align=left><BIG><B>软件开发</B></BIG> 
                  <CENTER><TT>用V C++检测和隔离内存泄漏(二)</TT></CENTER>
                  <P><BR>　　<B>使用_CrtSetDbgFlag</B><BR>　　如果你的程序总是在同一各地方存在，那么调用_CrtDumpMemoryLeaks时非常容易的。但是，如果你的程序需要在多个位置退出该怎么办？在每一个可能的出口处如果不调用_CrtDumpMemoryLeaks，你可在你的程序开始处包含下面的调用：<BR>　　_CrtSetDbgFlag( 
                  _CRTDBG_ALLOC_MEM_DF | 
                  _CRTDBG_LEAK_CHECK_DF);<BR>　　当程序退出时，这个说明自动地调用_CrtDumpMemoryLeaks。你必须设置两个位域，_CRTDBG_ALLOC_MEM_DF和 
                  _CRTDBG_LEAK_CHECK_DF。<BR><BR>　　<B>翻译内存模块的类型</B><BR>　　内存泄漏信息鉴别泄漏内存的每一个模块作为一个普通的模块、一个客户模块或者一个CRT模块。实际上，普通的模块和客户模块是你可能留心的唯一类型。<BR>　　一个普通模块(normal 
                  block)是由你的程序分配的普通内存。<BR>　　一个客户模块(client 
                  block)是一种特殊的内存模块，它由于需要一个析构函数的对象而被Microsoft Foundation Classes 
                  (MFC)所使用。MFC 
                  new操作子建立一个普通模块或者一个客户模块，来适合被创建的模块。<BR>　　一个CTR模块是由CRT库提供自己使用而分配的内存模块。CRT库对这些模块来管理自己的去分配，因此你不可能在内存泄漏报告中注意到这些，除非有些地方有严重的错误（例如，CRT库崩溃）。<BR>　　在内存泄漏信息中有两种你从来没有见过的模块类型：<BR>　　空闲模块（free 
                  block）是一种被释放的内存模块<BR>　　Ignore 
                  block是你已经特殊标记过以至于在内存泄漏报告中不会出现的模块。<BR><BR>　　<B>设置CRT报告样式</B><BR>　　像以前的一样，按默认方式，_CrtDumpMemoryLeaks倾卸内存泄漏信息到输出窗口的Debug窗格。你可以运用_CrtSetReportMode重新设置它到堆存处，到另一个位置。如果你使用一个库，它可能重新设置输出到另一个位置。在这种情况下，你能够利用下面的说明来设置输出位置回到输出窗口：<BR>　　_CrtSetReportMode( 
                  _CRT_ERROR, _CRTDBG_MODE_DEBUG 
                  );<BR>　　关于使用_CrtSetReportMode去发送输出信息到另一个位置，要看Visual 
                  C++文件的_CrtSetReportMode节。<BR><BR>　　<B>在内存分配数目处设置一个断点</B><BR>　　在内存泄漏报告中的文件名和行号可告诉你泄漏的内存在那里被分配，但是了解内存在那里分配对于鉴定问题不总是充分的。在一个程序运行过程中，经常是一个分配将会被调用很多次，但是它可能在某次调用中泄漏内存。为了确定问题，你必须不但知道泄漏的内存在那里分配，还要知道泄漏发生的条件。对你来说，使它成为可能的那条信息是内存分配号。当那些被显示的时候，文件名和行号之后，这是在curly 
                  brace中出现的数值。例如，在下面的输出中，"18"是内存分配号。它的意思是泄漏的内存是你程序中内存分配的第十八个模块。 <XMP>Detected memory leaks!
Dumping objects ->
C:\PROGRAM FILES\VISUAL STUDIO\MyProjects\leaktest\leaktest.cpp(20) : {18} normal block at 
0x00780E80, 64 bytes long.
Data: <                > CD CD CD CD CD CD CD CD CD CD CD CD CD CD CD CD 
Object dump complete.
</XMP><BR><BR></DIV></TD></TR></TBODY></TABLE><!-- 添加内容结束  //--></TD></TR>
        <TR>
          <TD vAlign=buttom align=middle width="100%" bgColor=#ffffff colSpan=2 
          height=10>|<A 
            href="http://asp.7i24.com/sg/tech/software/2001.01.05.htm#index">回顶部</A>|<A 
            href="javascript:(history.go(-1))">上一页</A>|<A 
            href="http://asp.7i24.com/index.html">主页面</A>| </TD></TR>
        <TR>
          <TD vAlign=buttom align=middle width="100%" bgColor=#ffffff colSpan=2 
          height=30>
            <P align=center>
            <HR color=#0066cc SIZE=1>
            <BR>建议使用800*600的分辩率，IE4以上的浏览器浏览以取得良好的效果 <BR>Copyright (C) 2001-2002 
            Netmay.Com All Rights Reserved<BR>Email: <A 
            href="mailto:skyidea@hotmail.com">skyidea@hotmail.com</A> 
            QQ:83150<BR></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></BODY></HTML>
