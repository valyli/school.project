<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0051)http://asp.7i24.com/sg/tech/software/2000.08.28.htm -->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=gb2312">
<META 
content="经济; IT产业; 金融; 投资; 经营; 技术; 网络; 软件开发; 安全技术; 站点制作; 免费; free; internet; wwwboard; headlines; downloads; news; Web site; what's new; solutions; services; software; contests; corporate news;" 
name=KEYWORDS>
<META content=网妹中国资讯网 name=description>
<STYLE type=text/css>BODY {
	FONT-SIZE: 9pt; COLOR: #000000; FONT-FAMILY: 宋体
}
.pt9 {
	FONT-SIZE: 9pt; FONT-FAMILY: "宋体"
}
.pt11 {
	FONT-WEIGHT: bold; FONT-SIZE: 11pt; COLOR: #336699; FONT-FAMILY: "宋体"
}
TT {
	FONT-WEIGHT: bold; FONT-SIZE: 10.5pt; COLOR: #000000; FONT-FAMILY: "宋体"
}
H5 {
	FONT-WEIGHT: bold; FONT-SIZE: 12pt; COLOR: #000000; FONT-FAMILY: "宋体"
}
P {
	FONT-SIZE: 9pt; COLOR: #000000; FONT-FAMILY: "宋体"
}
H9 {
	FONT-SIZE: 9pt; FONT-FAMILY: "宋体"
}
TD {
	FONT-SIZE: 9pt; FONT-FAMILY: "宋体"
}
SELECT {
	FONT-SIZE: 9pt; FONT-FAMILY: "宋体"
}
A:link {
	FONT-SIZE: 9pt; COLOR: #0022aa; FONT-FAMILY: "宋体"; TEXT-DECORATION: none
}
A:visited {
	FONT-SIZE: 9pt; COLOR: #0022aa; FONT-FAMILY: "宋体"; TEXT-DECORATION: none; font-color: blue
}
A:hover {
	FONT-SIZE: 9pt; COLOR: red; FONT-FAMILY: "宋体"; TEXT-DECORATION: underline
}
</STYLE>

<STYLE type=text/css>.d {
	LINE-HEIGHT: 12pt; MARGIN-RIGHT: 15px; TEXT-ALIGN: justify
}
</STYLE>

<SCRIPT language=JavaScript src="使用VC++取得CPU信息.files/hermes.js" 1.1></SCRIPT>

<META content="MSHTML 5.50.4134.100" name=GENERATOR></HEAD>
<BODY bgColor=#ffffff leftMargin=0 topMargin=0 MARGINWIDTH="0" 
MARGINHEIGHT="0"><A name=index></A>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top align=left width="17%" height=650>
      <TABLE height=1750 cellSpacing=0 cellPadding=0 width="100%" align=left 
      border=0 valign="top">
        <TBODY>
        <TR>
          <TD vAlign=top align=middle bgColor=#ffe4b5>
            <TABLE height=80 cellSpacing=0 cellPadding=0 width="90%" 
            align=center border=0 valign="top">
              <TBODY>
              <TR>
                <TD align=middle><IMG 
src="使用VC++取得CPU信息.files/logo.gif"></TD></TR>
              <TR>
                <TD align=middle><FONT size=2><A 
                  href="http://www.hermes.com.cn/">http://www.hermes.com.cn/</A></FONT></TD></TR>
              <TR>
                <TD vAlign=top align=middle width="100%" bgColor=#ffe4b5><IMG 
                  height=18 alt=海脉技术纵横 src="使用VC++取得CPU信息.files/jishu.gif" 
                  width=120 border=0></TD></TR>
              <TR>
                <TD vAlign=top align=left width="100%" bgColor=#ffe4b5 
                  height=2><IMG height=2 
              src="使用VC++取得CPU信息.files/blank.gif"></TD></TR>
              <TR>
                <TD vAlign=top width="100%" bgColor=#ffcf80 height=10><FONT 
                  color=#e0611e>◆</FONT><A target=rightdown 
                  href="http://asp.7i24.com/sg/tech/techinfo/index.htm">&nbsp;<H9>技术动态</H9></A></TD></TR>
              <TR>
                <TD vAlign=top align=left width="100%" bgColor=#ffe4b5 
                  height=2><IMG height=2 
              src="使用VC++取得CPU信息.files/blank.gif"></TD></TR>
              <TR>
                <TD vAlign=top width="100%" bgColor=#ffcf80 height=10><FONT 
                  color=#e0611e>◆</FONT><A target=rightdown 
                  href="http://asp.7i24.com/sg/tech/network/index.htm">&nbsp;<H9>网络技术</H9></A></TD></TR>
              <TR>
                <TD vAlign=top align=left width="100%" bgColor=#ffe4b5 
                  height=2><IMG height=2 
              src="使用VC++取得CPU信息.files/blank.gif"></TD></TR>
              <TR>
                <TD vAlign=top width="100%" bgColor=#ffcf80 height=10><FONT 
                  color=#e0611e>◆</FONT><A target=rightdown 
                  href="http://asp.7i24.com/sg/tech/software/index.htm">&nbsp;<H9>软件开发</H9></A></TD></TR>
              <TR>
                <TD vAlign=top align=left width="100%" bgColor=#ffe4b5 
                  height=2><IMG height=2 
              src="使用VC++取得CPU信息.files/blank.gif"></TD></TR>
              <TR>
                <TD vAlign=top width="100%" bgColor=#ffcf80 height=10><FONT 
                  color=#e0611e>◆</FONT><A target=rightdown 
                  href="http://asp.7i24.com/sg/tech/security/index.htm">&nbsp;<H9>安全技术</H9></A></TD></TR>
              <TR>
                <TD vAlign=top align=left width="100%" bgColor=#ffe4b5 
                  height=2><IMG height=2 
              src="使用VC++取得CPU信息.files/blank.gif"></TD></TR>
              <TR>
                <TD vAlign=top width="100%" bgColor=#ffcf80 height=10><FONT 
                  color=#e0611e>◆</FONT><A target=rightdown 
                  href="http://asp.7i24.com/sg/tech/pagemake/index.htm">&nbsp;<H9>站点制作</H9></A></TD></TR>
              <TR>
                <TD vAlign=top align=left width="100%" bgColor=#ffe4b5 
                  height=2><IMG height=2 
              src="使用VC++取得CPU信息.files/blank.gif"></TD></TR>
              <TR>
                <TD vAlign=top width="100%" bgColor=#ffcf80 height=10><FONT 
                  color=#e0611e>◆</FONT><A target=rightdown 
                  href="http://asp.7i24.com/sg/tech/faq/index.htm">&nbsp;<H9>技术问答</H9></A></TD></TR>
              <TR>
                <TD vAlign=top align=left width="100%" bgColor=#ffe4b5 
                  height=2><IMG height=2 
              src="使用VC++取得CPU信息.files/blank.gif"></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><!-- 左MENU代码结束  //--></TD>
    <TD vAlign=top align=left width="83%" height=650>
      <TABLE height=70 cellSpacing=0 cellPadding=2 width="100%" bgColor=#ffffff 
      border=0>
        <TBODY>
        <TR>
          <TD vAlign=BUTTOM align=left width="70%" bgColor=#ffffff 
            height=60><IFRAME marginWidth=0 marginHeight=0 
            src="使用VC++取得CPU信息.files/iframe.htm" frameBorder=0 width=468 
            scrolling=no 
            height=60> <a href="http://ad.hermes.com.cn/clickbanner.php?member=hermes"><img width="468" height="60" border="0" src="http://ad.hermes.com.cn/banner.php?size=0&member=hermes"></a></IFRAME><BR>
            <CENTER><A target=_blank 
            href="http://www.healliance.com/"></A></CENTER></TD>
          <TD vAlign=BUTTOM align=left width="30%" bgColor=#ffffff 
            height=60>&nbsp; </TD></TR></TBODY></TABLE>
      <TABLE height=500 cellSpacing=0 cellPadding=0 width="100%" bgColor=#ffffff 
      border=0>
        <TBODY>
        <TR>
          <TD vAlign=center align=left width="80%" bgColor=#ffe4b5 
            height=10>&nbsp;&nbsp;目前位置:<A 
            href="http://asp.7i24.com/sg/tech/rightnew.html">首页</A>&gt;&gt;软件开发 
          </TD>
          <TD vAlign=center align=middle width="20%" bgColor=#ececec 
            height=10>2000.8.28 </TD></TR>
        <TR>
          <TD vAlign=buttom align=middle width="100%" bgColor=#ffffff colSpan=2 
          height=430><!-- 添加内容开始  //-->
            <TABLE cellPadding=10 width="100%" border=0>
              <TBODY>
              <TR>
                <TD height=2>
                  <DIV align=left><BIG><B>软件开发</B></BIG> 
                  <H3>
                  <CENTER>使用VC++取得CPU信息</CENTER></H3>　　利用利用CPUID 汇编指令(机器码:0FH 
                  A2H, 如果你的编译器不支持CPUID 指 令，只有emit 机器码了)， 该指令可以被如下CPU识别 
                  <BR><BR>Intel 486 以上的CPU,<BR>Cyrix M1 以上的CPU,<BR>AMD Am486 
                  以上的CPU<BR><BR>　　(1) 取CPU OEM 字符串, 判断CPU 厂商 <BR>　　先让EAX=0， 
                  再调用CPUID <BR>　　　Inel的CPU将返回: <BR><BR>EBX:756E6547H 
                  'Genu'<BR>EDX:49656E69H 'ineI'<BR>ECX:6C65746EH 
                  'ntel'<BR>EBX,EDX,ECX 将连成"GenuineIntel", 
                  真正的Intel。<BR><BR>Cyrix 的CPU 
                  将返回:<BR><BR>EBX:43797269H<BR>EDX:78496E73H<BR>ECX:74656164H<BR>"CyrixInstead"，"Cyrix 
                  来代替"。<BR><BR>AMD 的CPU 
                  将返回:<BR><BR>EBX:41757468H<BR>EDX:656E7469H<BR>ECX:63414D44H<BR>"AuthenticAMD"， 
                  可信的AMD。<BR><BR>　　在Windows98中，用右键单击"我的电脑"，选择" 属性- 常规"在计算机描述 
                  处就可看见CPU OEM 字符串。<BR><BR>　　(2)CPU 到底是几86, 是否支持MMX 
                  <BR>　　先让EAX=1，再调用CPUID <BR>　　EAX的8到11位就表明是几86 <BR><BR>3 - 
                  386<BR>4 - i486<BR>5 - Pentium<BR>6 - Pentium Pro Pentium 
                  II<BR>2 - Dual Processors<BR><BR>　　EDX 
                  的第0位：有无FPU<BR><BR>　　EDX的第23位:CPU是否支持IA MMX,很重要啊 ！如果你想用那57条新增的指 
                  令,先检查这一位吧，否则就等着看Windows 的"该程序执行了非法指令，将被关 闭" 吧。 <BR><BR>　　(3) 
                  专门检测是否P6架构<BR>　　先让EAX=1，再调用CPUID <BR>　　如果AL=1,就是Pentium Pro 
                  或Pentium II <BR>　　(4) 专门检测AMD的CPU信息 
                  <BR>　　先让EAX=80000001H，再调用CPUID <BR>　　如果EAX=51H, 是AMD K5 
                  <BR>　　如 果EAX=66H, 是K6 <BR>　　EDX第0 位: 是否有FPU( 多余的 
                  ！谁用过没FPU的K5,K6?) <BR>　　EDX 第23 位，CPU是否支持MMX, 
                  <BR><BR>　　程序如下:<BR><BR>//------CPUID Instruction Demo 
                  Program------------<BR>#include <BR>#include <BR>#pragma 
                  hdrstop<BR>//------------------------------------------------<BR>#pragma 
                  inline<BR>#pragma argsused<BR>int main(int argc, char 
                  **argv)<BR>{<BR>char OEMString[13];<BR>int 
                  iEAXValue,iEBXValue,iECXValue,iEDXValue;<BR>_asm {<BR>mov 
                  eax,0<BR>cpuid<BR>mov DWORD PTR OEMString,ebx<BR>mov DWORD PTR 
                  OEMString+4,edx<BR>mov DWORD PTR OEMString+8,ecx<BR>mov BYTE 
                  PTR OEMString+12,0<BR>}<BR>cout&lt; &lt; "This CPU 's OEM 
                  String is:"&lt; &lt; OEMString&lt; &lt; endl;<BR>_asm {<BR>mov 
                  eax,1<BR>cpuid<BR>mov iEAXValue,eax<BR>mov 
                  iEBXValue,ebx<BR>mov iECXValue,ecx<BR>mov 
                  iEDXValue,edx<BR>}<BR>if(iEDXValue&amp;0x800000)<BR>cout &lt; 
                  &lt; "This is MMX CPU"&lt; &lt; endl;<BR>else<BR>cout &lt; 
                  &lt; "None MMX Support."&lt; &lt; endl;<BR>int 
                  iCPUFamily=(0xf00 &amp; iEAXValue) &gt; &gt;8;<BR>cout &lt; 
                  &lt; "CPU Family is:"&lt; &lt; iCPUFamily&lt; &lt; 
                  endl;<BR>_asm{<BR>mov 
                  eax,2<BR>CPUID<BR>}<BR>if(_AL==1)<BR>cout &lt; &lt; "Pentium 
                  Pro or Pentium II Found";<BR>getch();<BR>return 
                  0;<BR>}<BR><BR></DIV></TD></TR></TBODY></TABLE><!-- 添加内容结束  //--></TD></TR>
        <TR>
          <TD vAlign=buttom align=middle width="100%" bgColor=#ffffff colSpan=2 
          height=10>|<A 
            href="http://asp.7i24.com/sg/tech/software/2000.08.28.htm#index">回顶部</A>|<A 
            href="javascript:(history.go(-1))">上一页</A>|<A 
            href="http://asp.7i24.com/index.html">主页面</A>| </TD></TR>
        <TR>
          <TD vAlign=buttom align=middle width="100%" bgColor=#ffffff colSpan=2 
          height=30>
            <P align=center>
            <HR color=#0066cc SIZE=1>
            <BR>建议使用800*600的分辩率，IE4以上的浏览器浏览以取得良好的效果 <BR>Copyright (C) 2001-2002 
            Netmay.Com All Rights Reserved<BR>Email: <A 
            href="mailto:skyidea@hotmail.com">skyidea@hotmail.com</A> 
            QQ:83150<BR></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></BODY></HTML>
